import pyodbc
import pandas as pd
from bs4 import BeautifulSoup
import requests
from datetime import datetime
import time
import re


conn = pyodbc.connect('Driver={SQL Server};'
                      'Server=DESKTOP-HN763SI;'
                      'Database=disc_db;'
                      'Trusted_Connection=yes;')
cursor = conn.cursor()
query = 'SELECT * FROM pair_ID_table'


name_list = []

#converting pair_id_table to pandas df -> lists of url and id
df = pd.read_sql(query, conn)

name_list = df['proj_Name'].tolist()

print(len(name_list))

twitter_url_list = ['https://twitter.com/axieinfinity', 'https://twitter.com/thesandboxgame', 'https://mobile.twitter.com/undeadblocks', 'https://twitter.com/roguewestnft', 'https://mobile.twitter.com/chromatic_souls', 'https://mobile.twitter.com/cryptoshots_nft', 'https://twitter.com/supremacyyx%3Fref_src%3Dtwsrc%255Egoogle%257Ctwcamp%255Eserp%257Ctwgr%255Eauthor', 'https://mobile.twitter.com/pethereumgame', 'https://twitter.com/nft2040', 'https://mobile.twitter.com/championsp2e', 'https://twitter.com/coinhuntworld', 'https://mobile.twitter.com/goldenbrosnm', 'https://mobile.twitter.com/tales_of_angels', 'https://mobile.twitter.com/avariksaga', 'https://twitter.com/louieofgrace', 'https://mobile.twitter.com/toyoverse', 'https://mobile.twitter.com/zukimoba', 'https://mobile.twitter.com/cryptoconflict_', 'https://twitter.com/yakucorp', 'https://mobile.twitter.com/wondermannation', 'https://mobile.twitter.com/canaboyz', 'https://twitter.com/wordwidewebb', 'https://twitter.com/moonshotvoyage', 'https://mobile.twitter.com/drapiaofficial', 'https://mobile.twitter.com/cardano4speed', 'https://twitter.com/ninechronicles', 'https://mobile.twitter.com/officialtcgcoin', 'https://twitter.com/elementosio', 'https://twitter.com/thenestarcade%3Flang%3Dpt', 'https://mobile.twitter.com/worldofcryptoid', 'https://mobile.twitter.com/metatun', 'https://mobile.twitter.com/ageoftanksnft', 'https://twitter.com/metamorphpro', 'https://mobile.twitter.com/cornucopiasgame', 'https://mobile.twitter.com/legend_lfw', 'https://twitter.com/nftworldsnft', 'https://mobile.twitter.com/endersgate', 'https://mobile.twitter.com/snailtrailnft', 'https://twitter.com/devikins_game', 'https://twitter.com/legendarygoh/status/1358566310356090888', 'https://twitter.com/riotracers', 'https://mobile.twitter.com/lukcariocatasty', 'https://mobile.twitter.com/imperiumempires', 'https://mobile.twitter.com/terrafloki', 'https://twitter.com/bitlovincom', 'https://mobile.twitter.com/metaopsgaming', 'https://twitter.com/projectquantum_', 'https://mobile.twitter.com/guildsaga', 'https://mobile.twitter.com/karastargamefi', 'https://twitter.com/nifty_island', 'https://twitter.com/philtctos', 'https://mobile.twitter.com/uland_io', 'https://mobile.twitter.com/worldoffreight', 'https://mobile.twitter.com/fishcryptogame', 'https://twitter.com/bunnyknights', 'https://mobile.twitter.com/maviagame', 'https://twitter.com/mars_labs', 'https://mobile.twitter.com/pxpnftsgame', 'https://twitter.com/9talescomic', 'https://twitter.com/apegangnft', 'https://twitter.com/polker_pkr', 'https://twitter.com/playmining_sg/status/1410782381120712705', 'https://twitter.com/decimated_game', 'https://mobile.twitter.com/marscolonyio', 'https://twitter.com/splinterlands', 'https://twitter.com/byopills', 'https://mobile.twitter.com/playwizardia', 'https://mobile.twitter.com/pegaxyofficial', 'https://twitter.com/alienworlds%3Flang%3Dpt', 'https://mobile.twitter.com/drunk_robots', 'https://twitter.com/kryptomonteam%3Flang%3Dpt', 'https://twitter.com/cryptofights', 'https://twitter.com/search%3Fq%3D%2523MONSTEROFGOD', 'https://twitter.com/spacexstarship', 'https://mobile.twitter.com/mypethooligan', 'https://twitter.com/staratlas', 'https://mobile.twitter.com/panzerdogs', 'https://twitter.com/search%3Fq%3D%2523CryptoBladesKingdoms', 'https://twitter.com/landrockergame', 'https://twitter.com/playbigtime', 'https://twitter.com/chainoofficial', 'https://mobile.twitter.com/thecosmicguild', 'https://mobile.twitter.com/magiccraftgame', 'https://mobile.twitter.com/nftbillionaires', 'https://twitter.com/gamecredits', 'https://twitter.com/apeblock', 'https://www.whitelistidos.com/rebel-bots-ido-whitelist/', 'https://twitter.com/crypto_raiders', 'https://twitter.com/evaverse_nft', 'https://mobile.twitter.com/nftchampions', 'https://mobile.twitter.com/spellfireccg', 'https://twitter.com/cradlesio/status/1422128972612112384', 'https://mobile.twitter.com/farmmeofficiall', 'https://mobile.twitter.com/_megaweapon_', 'https://twitter.com/wilderworld', 'https://twitter.com/dracoo_master', 'https://mobile.twitter.com/tapfantasy2021', 'https://twitter.com/arconaico/status/947018448235909120', 'https://mobile.twitter.com/blockchainrpg', 'https://mobile.twitter.com/enginesoffury', 'https://twitter.com/bangergamesgg', 'https://twitter.com/netvrk1', 'https://mobile.twitter.com/cyballofficial', 'https://twitter.com/kogs_gg', 'https://mobile.twitter.com/playcolony', 'https://twitter.com/revomonvr', 'https://mobile.twitter.com/search%3Fq%3D%2523GoonsOfBalatroon', 'https://twitter.com/gogalagames', 'https://mobile.twitter.com/projectpigeons', 'https://mobile.twitter.com/metaguardians', 'https://twitter.com/habbo', 'https://twitter.com/webaverse', 'https://mobile.twitter.com/thefablednft', 'https://mobile.twitter.com/solchicksnft', 'https://twitter.com/blockchaincutie', 'https://mobile.twitter.com/pirateskingnft', 'https://mobile.twitter.com/micropetsbsc', 'https://twitter.com/1000blocks', 'https://mobile.twitter.com/bcmhunt', 'https://twitter.com/galaxyfight_nft', 'https://twitter.com/cryptcrusader', 'https://mobile.twitter.com/kfsnft', 'https://mobile.twitter.com/dragonevonft', 'https://mobile.twitter.com/clementinesgame', 'https://mobile.twitter.com/katanainu', 'https://mobile.twitter.com/troversenft', 'https://mobile.twitter.com/play_ukiyo', 'https://mobile.twitter.com/defendersrise', 'https://mobile.twitter.com/hashland_nft', 'https://mobile.twitter.com/GhostfaceCryptO/status/1478060150028005378', 'https://mobile.twitter.com/metananos', 'https://twitter.com/blackeyegalaxy_', 'https://twitter.com/thetreeverse', 'https://mobile.twitter.com/wolfdotgame', 'https://twitter.com/realsupducks', 'https://mobile.twitter.com/fishingtownbsc', 'https://mobile.twitter.com/pandaparadiseio', 'https://mobile.twitter.com/avaxtars_game', 'https://mobile.twitter.com/chainmyth', 'https://twitter.com/medabotsworld', 'https://mobile.twitter.com/metastrikehq', 'https://mobile.twitter.com/robo_rampage', 'https://mobile.twitter.com/wombatdungeon', 'https://twitter.com/starrynift', 'https://twitter.com/incarnategame', 'https://mobile.twitter.com/playcrabada', 'https://twitter.com/rplanetio', 'https://twitter.com/legendsofvenari%3Flang%3Dpt', 'https://twitter.com/ky_trixdzn', 'https://mobile.twitter.com/mekaminers', 'https://twitter.com/synergylandgame', 'https://twitter.com/killazspain', 'https://mobile.twitter.com/yieldhuntavax', 'https://mobile.twitter.com/search%3Fq%3D%2523Legendsofbezogia', 'https://mobile.twitter.com/cryptoroyaleone', 'https://mobile.twitter.com/elfinkingdom', 'https://mobile.twitter.com/tankwarszone', 'https://twitter.com/cropbytes', 'https://mobile.twitter.com/crypto_unicorns', 'https://mobile.twitter.com/bc_brawlers', 'https://mobile.twitter.com/kingdomxgame', 'https://mobile.twitter.com/moomonsternft', 'https://mobile.twitter.com/thematrixworld', 'https://mobile.twitter.com/blucanft', 'https://twitter.com/bitdogetoken', 'https://mobile.twitter.com/tankbattleco', 'https://twitter.com/mrmintopoly', 'https://mobile.twitter.com/starbots_game', 'https://twitter.com/inf_skies', 'https://mobile.twitter.com/monsterra_p2e', 'https://twitter.com/heroeschained', 'https://twitter.com/projectseedgame', 'https://twitter.com/superworldapp', 'https://mobile.twitter.com/meta_birds', 'https://mobile.twitter.com/eciospace', 'https://mobile.twitter.com/cindernft', 'https://twitter.com/zodium', 'https://twitter.com/godsunchained', 'https://mobile.twitter.com/erthagame', 'https://mobile.twitter.com/kryxivia', 'https://twitter.com/voxiesnft', 'https://mobile.twitter.com/metalandsgg', 'https://twitter.com/playtimeraiders', 'https://mobile.twitter.com/axesmetaverse', 'https://twitter.com/moonienft', 'https://mobile.twitter.com/plutoniansgame', 'https://mobile.twitter.com/streetrunnernft', 'https://mobile.twitter.com/galaxy_sidus', 'https://twitter.com/seascapenetwork', 'https://twitter.com/vulcanverse', 'https://twitter.com/parallelnft', 'https://twitter.com/search%3Fq%3D%2523Alterverse', 'https://mobile.twitter.com/openblox_io', 'https://twitter.com/sorare', 'https://twitter.com/projectnebula_', 'https://twitter.com/warriders', 'https://twitter.com/jmibster', 'https://twitter.com/theupliftworld', 'https://twitter.com/influenceth', 'https://twitter.com/pocket', 'https://mobile.twitter.com/mechachain', 'https://mobile.twitter.com/ninnekogame', 'https://twitter.com/osiris_br%3Fref_src%3Dtwsrc%255Egoogle%257Ctwcamp%255Eserp%257Ctwgr%255Eauthor', 'https://twitter.com/chibidangonft', 'https://mobile.twitter.com/koingamesio', 'https://twitter.com/_universeisland', 'https://twitter.com/RumbleKongs/status/1434930324253941763', 'https://mobile.twitter.com/metageargame', 'https://mobile.twitter.com/peakminesnft', 'https://twitter.com/CastielB21/status/1482331771089965061', 'https://mobile.twitter.com/cuboidsnft', 'https://mobile.twitter.com/happyland_hpl', 'https://mobile.twitter.com/heroesempires', 'https://twitter.com/clashofstreamer', 'https://twitter.com/cyberkongz', 'https://twitter.com/spacemisfits', 'https://mobile.twitter.com/chumbivalley', 'https://mobile.twitter.com/chicablockchain', 'https://mobile.twitter.com/dorac_official', 'https://mobile.twitter.com/cryptospacewar', 'https://mobile.twitter.com/piratesworldnft', 'https://twitter.com/veggiesfarm', 'https://mobile.twitter.com/battleverse_io', 'https://mobile.twitter.com/mousehaunt', 'https://twitter.com/search%3Fq%3D%2523BattleWave2323', 'https://twitter.com/era7_official%3Flang%3Dpt', 'https://twitter.com/chain_guardians', 'https://twitter.com/playdapp_io', 'https://mobile.twitter.com/ciphershooters', 'https://twitter.com/thenemesis_io', 'https://mobile.twitter.com/paladin_pandas', 'https://mobile.twitter.com/wamapp', 'https://mobile.twitter.com/furbrawls', 'https://twitter.com/somniumspace', 'https://mobile.twitter.com/tinycolonygame', 'https://twitter.com/chaincadebsc', 'https://mobile.twitter.com/realfevr%3Flang%3Dpt', 'https://twitter.com/usask/status/1319402906311852034', 'https://twitter.com/gunstar_io', 'https://mobile.twitter.com/csdgame', 'https://mobile.twitter.com/catch_king', 'https://twitter.com/theufotoken', 'https://twitter.com/cryptomotors_io', 'https://twitter.com/search%3Fq%3D%2523YooShiGamePad', 'https://mobile.twitter.com/hamstergamenft', 'https://twitter.com/babyswap_bsc', 'https://mobile.twitter.com/secondlivereal', 'https://mobile.twitter.com/geopoly_game', 'https://twitter.com/riseonlineworld', 'https://mobile.twitter.com/9dnft', 'https://twitter.com/prospectorsgame', 'https://twitter.com/guilhermeboulos/status/1252250654057402372', 'https://twitter.com/lightning', 'https://twitter.com/mininations', 'https://twitter.com/theguildcast', 'https://twitter.com/victoriavrcom', 'https://twitter.com/polkafantasy', 'https://twitter.com/aavegotchi', 'https://mobile.twitter.com/nunuspiritsnft', 'https://twitter.com/uplandme', 'https://mobile.twitter.com/aleague_racing', 'https://twitter.com/cryptovoxels', 'https://twitter.com/illuviumio', 'https://twitter.com/farming_tales', 'https://mobile.twitter.com/mechmaster_io', 'https://twitter.com/thndrgames/status/1311643741409751041', 'https://twitter.com/genso_meta', 'https://mobile.twitter.com/metasoccer_en', 'https://twitter.com/playhashrush', 'https://twitter.com/realisnetwork/status/1428404761913667585', 'https://mobile.twitter.com/thelastwar_p2e', 'https://mobile.twitter.com/ark_rivals', 'https://mobile.twitter.com/hyperjump_fi', 'https://mobile.twitter.com/the_phantom_g', 'https://twitter.com/apwars', 'https://twitter.com/deepspacebsc', 'https://twitter.com/bullieverse%3Flang%3Dpt', 'https://mobile.twitter.com/herocatgamefi', 'https://twitter.com/playhearthstone', 'https://twitter.com/wrathoftezca', 'https://twitter.com/rollercoin_com', 'https://twitter.com/cardanowarriors', 'https://mobile.twitter.com/sharkraceclub', 'https://mobile.twitter.com/wizarregame', 'https://mobile.twitter.com/polarpals_nft', 'https://twitter.com/nftpanda', 'https://mobile.twitter.com/cashcowprotocol', 'https://twitter.com/crypto_prophets', 'https://twitter.com/cryptowarsou', 'https://twitter.com/godsnlegends', 'https://mobile.twitter.com/adaquestgame', 'https://twitter.com/realrealmgame', 'https://mobile.twitter.com/titan_hunters', 'https://twitter.com/auroryproject', 'https://twitter.com/CryptoMonkeyEmp/with_replies', 'https://mobile.twitter.com/playttk', 'https://twitter.com/legendsofmitra', 'https://twitter.com/survivingsol', 'https://twitter.com/search%3Fq%3D%2523gravisfinance', 'https://mobile.twitter.com/kartracingnft', 'https://mobile.twitter.com/cybercityinc', 'https://mobile.twitter.com/unfam_territory', 'https://twitter.com/metadrace%3Flang%3Dpt', 'https://mobile.twitter.com/zoolana_', 'https://mobile.twitter.com/worldofdefish', 'https://twitter.com/shillywonkabsc', 'https://mobile.twitter.com/cfcfighting', 'https://twitter.com/immersys', 'https://mobile.twitter.com/0xspacesip', 'https://twitter.com/gnocityio', 'https://twitter.com/canal_do_void', 'https://twitter.com/darkforest_eth%3Flang%3Dpt', 'https://twitter.com/green_beli', 'https://twitter.com/gameeapp', 'https://twitter.com/mimiquiz%3Flang%3Des', 'https://mobile.twitter.com/lunarush_lus', 'https://twitter.com/cityalpaca', 'https://twitter.com/search%3Fq%3D%2523bithotel', 'https://twitter.com/monstergalaxy21', 'https://mobile.twitter.com/oddballclubnft', 'https://twitter.com/rendercraft3d', 'https://mobile.twitter.com/wndgame', 'https://mobile.twitter.com/thesamuraidoge', 'https://twitter.com/supermonkeyball', 'https://twitter.com/knightlandsgame', 'https://twitter.com/flanders_sa', 'https://twitter.com/nftwhalealert/status/1465357385493467141', 'https://mobile.twitter.com/thelostglitches', 'https://mobile.twitter.com/mechcraftworld', 'https://twitter.com/defi_land%3Flang%3Dpt', 'https://mobile.twitter.com/elpisbattle', 'https://twitter.com/bunicornswap', 'https://mobile.twitter.com/thevoicenft', 'https://mobile.twitter.com/idle_mystic', 'https://twitter.com/NiftyMuseum%3Fref_src%3Dtwsrc%255Etfw', 'https://mobile.twitter.com/dragonlandband', 'https://mobile.twitter.com/farmpoly', 'https://twitter.com/stepheronfts/status/1478365791477280776']

print(len(twitter_url_list))

i = 0

##while(i<(len(name_list))):
##    google_search = name_list[i] + " twitter"
##    search_url = "https://www.google.com/search?q=" + google_search
##    r = requests.get(search_url)
##    soup = BeautifulSoup(r.text, 'html.parser')
##    raw = str(soup.h3.parent)
##    split = raw.split("q=")
##    split2 = split[1].split("&")
##    print(split2[0])
##    twitter_url_list.append(split2[0])
##    
##    if(i % 10 == 0) : time.sleep(30)
##    i += 1



##
##print(twitter_url_list)






##
##r = requests.get(url_link)
##soup = BeautifulSoup(r.text, 'html.parser')
##

##conn.commit()    
cursor.close()
conn.close()
